---
// A simple dark/light mode toggle.  This component does not accept any
// properties.  It writes its state to localStorage so that the userâ€™s
// preference persists between visits.  When the button is clicked the
// `dark` class is toggled on the <html> element.
---
<button
  type="button"
  id="theme-toggle"
  aria-label="Toggle dark mode"
  class="p-2 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
>
  <!-- Sun icon (light mode) -->
  <svg
    class="w-5 h-5 text-yellow-500 dark:hidden"
    fill="currentColor"
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M10 15a5 5 0 100-10 5 5 0 000 10zM10 2a1 1 0 011-1 1 1 0 110 2 1 1 0 01-1-1zM10 18a1 1 0 011-1 1 1 0 110 2 1 1 0 01-1-1zM4.222 5.636a1 1 0 011.414-1.414 1 1 0 11-1.414 1.414zM16.364 17.778a1 1 0 011.414-1.414 1 1 0 11-1.414 1.414zM2 10a1 1 0 112 0 1 1 0 11-2 0zM18 10a1 1 0 112 0 1 1 0 11-2 0zM4.222 14.364a1 1 0 001.414 1.414 1 1 0 11-1.414-1.414zM16.364 2.222a1 1 0 001.414 1.414 1 1 0 11-1.414-1.414z"
    />
  </svg>
  <!-- Moon icon (dark mode) -->
  <svg
    class="w-5 h-5 text-blue-400 hidden dark:block"
    fill="currentColor"
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M17.293 13.293a8 8 0 01-10.586-10.586A8 8 0 1017.293 13.293z"
    />
  </svg>
</button>

<script>
  // Immediately invoked function to set the initial theme on page load.  This
  // script runs on the client side because it accesses `window` and
  // `localStorage`.
  (() => {
    if (typeof window === 'undefined') return;
    const stored = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const initial = stored ?? (prefersDark ? 'dark' : 'light');
    document.documentElement.classList.toggle('dark', initial === 'dark');
  })();
  // Attach event listener after DOM is ready
  document.addEventListener('DOMContentLoaded', () => {
    const button = document.getElementById('theme-toggle');
    button?.addEventListener('click', () => {
      const isDark = document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });
  });
</script>